---
title: "WHERE, GROUP BY, HAVING, ORDER BY절"
excerpt: "SQLD 정리"

categories:
  - Database
tags:
  - [tag1, tag2]

permalink: /database/sql/3_3

toc: true
toc_sticky: true

date: 2024-11-05
last_modified_at: 2024-11-05
---

## WHERE절
특정 조건을 만족하는 행만을 대상으로 연산을 수행한다.
SELECT뿐만 아니라, UPDATE, DELETE에도 사용할 수 있으나 INSERT에는 사용할 수 없다.<br/>
*FROM 절이 먼저 수행되므로 FROM절에서 정의한 별칭은 사용 가능하나 SELECT절에서 정의한 별칭은 사용할 수 없다.*

### 비교연산자
**단일행 비교연산자**
- =, <, <=, >=, >
- IS NULL : NULL 이면 참을 반환

**다중행 비교연산자**
- IN : 리스트 중 동일한 값이 하나라도 있으면 참
- EXISTS : 서브쿼리의 결과가 한 건이라도 있으면 참 (EXISTS는 서브쿼리를 대상으로만 사용 가능)
- ALL : 리스트 각각의 원소와 비교하여 모두 참이면 참. 단일행 비교연산자와 결합하여 사용
- ANY : 리스트 각각의 원소와 비교하여 하나라도 참이면 참. 단일행 비교연산자와 결합하여 사용
```sql
WHERE C1 IN (10, 20, 30);
# -> C1 = 10 OR C1 = 20 OR C1 = 30 
WHERE EXISTS(SELECT * FROM TBL);
# -> TBL 테이블에 데이터가 한 건이라도 존재 하는가
WHERE C1 < ALL(10, 20, 30);
# -> WHERE C1 < 10 AND C1 < 20 AND C1 < 30
WHERE C1 < ANY(10, 20, 30);
# -> WHERE C1 < 10 OR C1 < 20 OR C1 < 30
```
### 부정 비교연산자
**단일행 부정 비교연산자**
- !=, ^=, <> : 두 값이 서로 다르면 참
- IS NOT NULL : NULL이 아니면 참

**다중행 부정 비교연산자**
- NOT IN     : 리스트 중 동일한 값이 하나도 없으면 참
- NOT EXISTS : 서브쿼리의 결과가 한 건도 없으면 참

### SQL 연산자
- BETWEEN A AND B : A 이상 B 이하면 참
- LIKE : 패턴문자열로 문자 검색시 사용 
  - % : 0개 이상의 문자
  - _ : 임의의 문자 1개
  
```sql
LIKE %M%;
# -> 중간에 M이 있는 문자열
LIKE _M;
# -> M으로 끝나는 길이가 2개인 문자열 
 ```

### 부정 SQL 연산자
- NOT BETWEEN A AND B : A 미만 B 초과시 참
- NOT LIKE : 패턴에 매칭되는 것이 하나도 없으면 참

### 논리연산자
- AND : AND로 연결된 모든 조건이 참이면 참
- OR : OR로 연결된 조건 중에 하나가 참이면 참
- NOT : 뒤에 오는 식의 참 / 거짓의 반대를 반환

## GROUP BY, HAVING 절
### GROUP BY
데이터를 그룹핑한다.<br>
부하가 높은 연산이므로 WHERE절을 사용해서 필터링을 먼저 하는 것이 좋다.

### 집계함수
집계함수는 그룹을 대상으로 연산을 수행하는 다중행 함수이다.<br>
GROUP BY절이 없이 집계함수를 사용하면 전체 행을 하나의 그룹으로 보고 연산을 수행한다.

- COUNT : 입력된 칼럼에서 값이 Null인 행을 제외한 행의 개수를 반환
- SUM : 입력된 칼럼의 합을 반환
- AVG : 입력된 칼럼의 평균을 반환
- MIN : 입력된 칼럼의 최솟값을 반환
- MAX : 입력된 칼럼의 최댓값을 반환

> **DISTINCT** 칼럼값의 중복을 제거한다.<br> 따라서 집계함수의 인자로 입력되는 칼럼명에 사용하면 해당 그룹에서 첫 번째 행에 대해서만 연산을 수행한다.

### HAVING
WHERE절과 달리 집계함수를 사용할 수 있다.
일반적으로 GROUP BY 연산이 끝난 결과에 대해 필터링을 수행한다. <br/>
GROUP BY절이 없이 사용하면 전체 행을 하나의 그룹으로 보고 조건식을 수행하며,<br/>
조건식에 따라 조회하고자 하는 칼럼의 표현식이 적합하지 않으면 오류가 발생한다.

### ORDER BY 절
관계형 데이터베이스가 가지는 **튜플의 무순서성**에 따라 테이블에 삽입된 데이터는 순서가 없이 저장된다.
-> 조회시 임의의 순서로 출력이 되고 정렬시 비용 발생
DBSM에 따라 Null값을 최소 / 최대로 다르게 처리한다.

- ASC : 오름차순 (생략시 오름차순)
- DESC : 내림차순

```sql
ORDER BY 칼럼명 DESC;
# 칼럼명에 대해 내림차순 정렬
```
